<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bayesCT: An R package for Simulation in Adaptive Bayesian Clinical Trials • bayesCT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="bayesCT: An R package for Simulation in Adaptive Bayesian Clinical Trials">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesCT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bayesCT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/binomial.html">Binomial Outcome</a>
    </li>
    <li>
      <a href="../articles/normal.html">Normal Outcome</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thevaachandereng/bayesCT">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>bayesCT: An R package for Simulation in Adaptive Bayesian Clinical Trials</h1>
                        <h4 class="author">Thevaa Chandereng, Donald Musgrove, Tarek Haddad, Graeme Hickey, Timothy Hanson, Theodore Lystig</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thevaachandereng/bayesCT/blob/master/vignettes/bayesCT.Rmd"><code>vignettes/bayesCT.Rmd</code></a></small>
      <div class="hidden name"><code>bayesCT.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Randomized controlled trials (RCT) are the gold standard of pharmaceutical and medical device clinical studies. In a two-armed RCT, subjects are randomized to an intervention arm, with the standard framework being the comparison of a new treatment/drug to a current treatment/drug (control). The majority of research in the design of RCTs and their application is based on the frequentist paradigm. In recent years, the adaptive Bayesian trial design approach has gained attention.</p>
<p>Adaptive Bayesian trials provide added flexibility compared to conventional frequentist approaches in terms of the design and analysis of a clinical trial. Notably, adaptive Bayesian trials can:</p>
<ul>
<li>Incorporate historical data, helping to reduce the sample size</li>
<li>Easily carry out interim analyses to facilitate stopping early for success or futility</li>
<li>Work with multiple treatment arms (versus a single control), allowing for dropping of demonstrably unsuccessful treatments</li>
<li>Alter the randomization ratio (e.g., treatment to control ratio) to improve trial efficiency or even to increase trial recruitment</li>
</ul>
<p>A fundamental requirement of an adaptive trial is the <em>a priori</em> and interim evaluation of the operating characteristics. In adaptive trials, these operating characteristics generally do not have a closed-form; hence, simulation approaches are required. Simulation of adaptive Bayesian trial designs have historically been substantially more complex compared to frequentist approaches. This package removes this complexity obstacle and allows for simulation of adaptive Bayesian trials under a range of designs and outcome types.</p>
<p><code>bayesCT</code> is an R package for the simulation and analysis of adaptive Bayesian randomzied controlled trials under a range of trial designs and outcome types. Currently, it supports Gaussian and binomial data types, with time-to-event data to follow soon. The package allows the (optional) incorporation of historical data and permits interim analyses of early stopping for futility or success. Please note this package is still under development.</p>
<p>If you use <code>bayesCT</code> in published research, please cite: <strong>TBA</strong>.</p>
<p>If after reading through this vignette you have questions or problems using <code>bayesCT</code>, please post them to <a href="https://github.com/thevaachandereng/bayesCT/issues" class="uri">https://github.com/thevaachandereng/bayesCT/issues</a>. This will notify the package maintainers and we can work to address the issue(s). Please note that comments and questions should <strong>not</strong> be emailed directly to the package authors.</p>
</div>
<div id="running-bayesct" class="section level1">
<h1 class="hasAnchor">
<a href="#running-bayesct" class="anchor"></a>Running bayesCT</h1>
<p>Prior to analyzing your data, the R package needs to be installed. The easiest way to install <code>bayesCT</code> is through CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"bayesCT"</span>)</a></code></pre></div>
<p>There are additional ways to download <code>bayesCT</code>. The first option is most useful for downloading a specific version of <code>bayesCT</code> (which can be found at <a href="https://github.com/thevaachandereng/bayesCT/releases" class="uri">https://github.com/thevaachandereng/bayesCT/releases</a>):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"thevaachandereng/bayesCT@vx.xx.x"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># or </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_version</a></span>(<span class="st">"bayesCT"</span>, <span class="dt">version =</span> <span class="st">"x.x.x"</span>, <span class="dt">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</a></code></pre></div>
<p>The second option is to download the most recent stable version through GitHub:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"thevaachandereng/bayesCT"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="ot">FALSE</span> Downloading GitHub repo thevaachandereng<span class="op">/</span>bayesCT<span class="op">@</span>master</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="ot">FALSE</span>   </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">   checking <span class="cf">for</span> file ‘<span class="op">/</span>tmp<span class="op">/</span>RtmpSf84yU<span class="op">/</span>remotes377d104f49c7<span class="op">/</span>thevaachandereng<span class="op">-</span>bayesCT<span class="op">-</span>420ad58<span class="op">/</span>DESCRIPTION’ ...</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">✔  checking <span class="cf">for</span> file ‘<span class="op">/</span>tmp<span class="op">/</span>RtmpSf84yU<span class="op">/</span>remotes377d104f49c7<span class="op">/</span>thevaachandereng<span class="op">-</span>bayesCT<span class="op">-</span>420ad58<span class="op">/</span>DESCRIPTION’</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">─  preparing ‘bayesCT’<span class="op">:</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">   checking DESCRIPTION meta<span class="op">-</span>information ...</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb3-15" data-line-number="15">✔  checking DESCRIPTION meta<span class="op">-</span>information</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb3-18" data-line-number="18">─  checking <span class="cf">for</span> LF line<span class="op">-</span>endings <span class="cf">in</span> source and make files and shell scripts</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb3-21" data-line-number="21">─  checking <span class="cf">for</span> empty or unneeded directories</a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="ot">FALSE</span> ─  looking to see <span class="cf">if</span> a ‘data<span class="op">/</span>datalist’ file should be added</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb3-25" data-line-number="25">─  building ‘bayesCT_<span class="dv">1</span>.<span class="dv">0</span>.<span class="fl">0.</span>tar.gz’</a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-27" data-line-number="27">  </a>
<a class="sourceLine" id="cb3-28" data-line-number="28">   </a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="ot">FALSE</span> Installing package into <span class="st">'/home/travis/R/Library'</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="ot">FALSE</span> (as <span class="st">'lib'</span> is unspecified)</a></code></pre></div>
<p>After successful installation, the package must be loaded into the working space:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(bayesCT)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'bayesCT'</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;     simulate</span></a></code></pre></div>
</div>
<div id="recruitment" class="section level1">
<h1 class="hasAnchor">
<a href="#recruitment" class="anchor"></a>Recruitment</h1>
<p>The trial subject recruitment rate is assumed to follow a Poisson process. Since trial recruitment is independent, the <a href="https://en.wikipedia.org/wiki/Memorylessness">“memoryless property”</a> modeling of subject recruitment is used. However, we typically do not assume a homogeneous Poisson process since subject recruitment varies over time.</p>
<p>The <code><a href="https://www.rdocumentation.org/packages/bayesCT/topics/enrollment">enrollment()</a></code> function is used to specify subject enrollment into the trial. The function assumes a piecewise stationary Poisson process with the ability to specify different enrollment rates, i.e., the Poisson rates, at different time intervals. The first trial enrollment is assumed to occur at time zero.</p>
<p>To illustrate, suppose we use a piecewise function to specify the change in enrollment rate over time: <span class="math display">\[  \lambda = \left\{
\begin{array}{ll}
      0.3 &amp; t \in [0, 5) \\
      0.7 &amp; t \in [5, 10) \\
      0.9 &amp; t \in [10, 15) \\
      1.2 &amp; t \in [15, \infty) \\
\end{array} 
\right. \]</span></p>
<p>Then, to simulate individual patient enrollment dates with a sample size (<code>N_total</code>) of 50, we use</p>
<pre><code>#&gt;  [1]  0  1  2  2 11 11 13 14 15 15 16 18 19 19 24 24 25 25 25 26 27 28 28
#&gt; [24] 29 29 29 29 30 31 33 34 36 37 37 39 40 40 45 46 46 47 48 48 52 52 52
#&gt; [47] 55 57 58 58</code></pre>
</div>
<div id="randomization-scheme" class="section level1">
<h1 class="hasAnchor">
<a href="#randomization-scheme" class="anchor"></a>Randomization scheme</h1>
<p>The randomization allocation is an important aspect of the design of an RCT. Complete randomization may not always be ideal due to the chance of drawing a large block of a single treatment arm, potentially impacting the time to enrollment completion. Therefore, a block randomization allocation may be preferable.</p>
<p>In <code>bayeCT</code>, the block randomization allocation specification allows for different randomization ratios, but they must be given in integer form. Additionally, the block size should be an integer that is divisible by the sum of the randomization allocation. For example,</p>
<p>will not work because the sum of the allocation is not a multiple of the block.</p>
<pre><code>#&gt;   [1] 0 1 0 0 0 1 0 0 0 1 1 0 1 1 0 0 0 0 0 0 1 1 0 0 1 0 1 0 0 0 0 1 0 1 0
#&gt;  [36] 0 0 1 0 0 1 0 0 1 0 0 0 1 0 0 1 0 0 1 1 1 0 0 0 0 0 0 1 1 0 0 0 1 0 0
#&gt;  [71] 0 1 1 0 1 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 0 1 0 0 1 1 0 0 1 0 0 1 0 0
#&gt; [106] 0 1 0 0 0 1 0 1 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 1 0 1 0 0 1 0 0 1 0 0</code></pre>
<p>In the code above, the total sample size is 140, the block size is 6 and the randomization ratio is 2:1 for control to treatment. Since <span class="math inline">\(2+1 = 3\)</span> is a multiple of the block size of 6, this allocation is valid.</p>
<p>Complete randomization can be performed by setting the block size equal to the total sample size:</p>
<pre><code>#&gt;   [1] 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 0 1 0 1 0 1 0 0 0 1
#&gt;  [36] 1 0 0 0 0 0 1 0 1 0 0 1 0 0 1 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0
#&gt;  [71] 1 0 1 0 0 1 0 0 1 0 1 0 1 0 0 1 0 1 1 1 0 0 1 0 1 0 0 0 0 1 1 0 0 1 0
#&gt; [106] 1 0 0 1 0 1 0 0 1 0 1 0 0 0 0</code></pre>
</div>
<div id="incorporation-of-historical-data" class="section level1">
<h1 class="hasAnchor">
<a href="#incorporation-of-historical-data" class="anchor"></a>Incorporation of historical Data</h1>
<p>The Bayesian attitude is to use all available data to address the scientific question under consideration. Most clinical trials are not conducted in a vacuum. Often, pilot studies are conducted in small sample sizes to obtain an estimate of parameters for a clinical trial, e.g., clinically relevant effect size, sample size determination, recruitment rates, etc. Besides pilot studies, the control and/or treatment are usually studied in early phase lab or bench settings. However, clinical trialists need to carefully consider the inclusion and exclusion criteria of historical data in a trial. The R package <code>bayesDP</code> is used as a computational engine for incorporating historical data into a trial design.</p>
<p>The vignettes presented in the <code>bayesDP</code> package are a rich resource for unstanding the discount function approach and its implementation. Interested readers can refer to the vignettes avaialable at <a href="https://cran.r-project.org/web/packages/bayesDP/" class="uri">https://cran.r-project.org/web/packages/bayesDP/</a>.</p>
</div>
<div id="early-stopping-for-futility-or-success" class="section level1">
<h1 class="hasAnchor">
<a href="#early-stopping-for-futility-or-success" class="anchor"></a>Early Stopping for Futility or Success</h1>
<p>With adaptive Bayesian trials, the trial can be stopped early for success or futility. In <code>bayesCT</code>, early success is achieved if the “probability of sucess” exceeds a pre-specified threshold. Likewise, futility occurs if the “probability of futility” is below a pre-specified threshold. In both cases, the probabilities are computed by imputing subjects that may be loss to follow-up. However, final posterior estimation uses complete data only.</p>
<div id="success" class="section level2">
<h2 class="hasAnchor">
<a href="#success" class="anchor"></a>Success</h2>
<p>The probability of stopping early for success is specified as</p>
<p><span class="math display">\[Pr(\theta_T - \theta_C &gt; \delta| y, y_0) &gt; \Delta,\]</span></p>
<p>where <span class="math inline">\(\theta_T\)</span> and <span class="math inline">\(\theta_C\)</span> are the posterior means of the treatment and control groups, respectively, <span class="math inline">\(\delta\)</span> is the difference margin (important in non-inferiority design), <span class="math inline">\(y\)</span> and <span class="math inline">\(y_0\)</span> are the current and historical data, respectively, and <span class="math inline">\(\Delta\)</span> is the specified success criteria. If this probability exceeds <span class="math inline">\(\Delta\)</span>, the trial will stop enrollment for early success. The default success probability is 0.90. If stopping early for success is not desired, the probability can be set to 1.</p>
</div>
<div id="futility" class="section level2">
<h2 class="hasAnchor">
<a href="#futility" class="anchor"></a>Futility</h2>
<p>The probability of stopping for futility is specified as</p>
<p><span class="math display">\[Pr(\theta_T - \theta_C &gt; \delta| y, y_0) &lt; \omega,\]</span></p>
<p>where <span class="math inline">\(\omega\)</span> is the specified futility criteria. Now, if this probability is below <span class="math inline">\(\omega\)</span>, the trial will stop enrollment for futility. The default futility rate is set to 0.10. If stopping early for futility is not desired, the probability can be set to 0.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#running-bayesct">Running bayesCT</a></li>
      <li><a href="#recruitment">Recruitment</a></li>
      <li><a href="#randomization-scheme">Randomization scheme</a></li>
      <li><a href="#incorporation-of-historical-data">Incorporation of historical Data</a></li>
      <li>
<a href="#early-stopping-for-futility-or-success">Early Stopping for Futility or Success</a><ul class="nav nav-pills nav-stacked">
<li><a href="#success">Success</a></li>
      <li><a href="#futility">Futility</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thevaa Chandereng, Donald Musgrove, Tarek Haddad, Graeme Hickey, Timothy Hanson, Theodore Lystig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
